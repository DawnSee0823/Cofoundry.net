angular.module("cms.settings",["ngRoute","cms.shared"]).constant("_",window._).constant("settings.modulePath","/Admin/Modules/Settings/Js/"),angular.module("cms.settings").config(["$routeProvider","shared.routingUtilities","settings.modulePath",function(e,t,n){e.otherwise(t.mapOptions(n,"SettingsDetails"))}]),angular.module("cms.settings").factory("settings.settingsService",["$http","shared.serviceBase",function(t,n){var e={},a=n+"settings",i=a+"/generalsite",o=a+"/seo";return e.getGeneralSiteSettings=function(){return t.get(i)},e.getSeoSettings=function(){return t.get(o)},e.updateGeneralSiteSettings=function(e){return t.patch(i,e)},e.updateSeoSettings=function(e){return t.patch(o,e)},e.clearCache=function(e){return t.delete(n+"cache")},e}]),angular.module("cms.settings").controller("SettingsDetailsController",["_","$q","shared.LoadState","shared.permissionValidationService","settings.settingsService","settings.modulePath",function(t,a,e,n,i,o){var s=this;function l(){s.editMode=!0,s.mainForm.formStatus.clear()}function r(){var e;e=s.saveLoadState,s.globalLoadState.on(),e&&t.isFunction(e.on)&&e.on(),i.updateGeneralSiteSettings(s.generalSettingsCommand).then(i.updateSeoSettings.bind(null,s.seoSettingsCommand)).then(d.bind(null,"Changes were saved successfully")).finally(f.bind(null,s.saveLoadState))}function u(){s.editMode=!1,S(),s.mainForm.formStatus.clear()}function c(){s.globalLoadState.on(),i.clearCache().then(d.bind(null,"Cache cleared")).finally(s.globalLoadState.off)}function d(e){return g().then(s.mainForm.formStatus.success.bind(null,e))}function g(){var e=i.getGeneralSiteSettings().then(n.bind(null,"generalSettings")),t=i.getSeoSettings().then(n.bind(null,"seoSettings"));return a.all([e,t]).then(function(){S(),s.editMode=!1});function n(e,t){s[e]=t}}function S(){s.seoSettingsCommand=t.clone(s.seoSettings),s.generalSettingsCommand=t.clone(s.generalSettings)}function f(e){s.globalLoadState.off(),e&&t.isFunction(e.off)&&e.off()}s.edit=l,s.save=r,s.cancel=u,s.clearCache=c,s.editMode=!1,s.globalLoadState=new e,s.saveLoadState=new e,s.formLoadState=new e(!0),s.canUpdateSettings=n.hasPermission("COFSETGENUPD"),g().then(f.bind(null,s.formLoadState))}]);