angular.module("cms.account",["ngRoute","cms.shared"]).constant("_",window._).constant("account.modulePath","/Admin/Modules/Account/Js/"),angular.module("cms.account").config(["$routeProvider","shared.routingUtilities","account.modulePath",function(t,a,n){t.when("/change-password",a.mapOptions(n,"ChangePassword")).otherwise(a.mapOptions(n,"AccountDetails"))}]),angular.module("cms.account").factory("account.accountService",["$http","shared.serviceBase",function(a,t){var n={},o=t+"account";return n.getAccountDetails=function(){return a.get(o)},n.update=function(t){return a.patch(o,t)},n.updatePassword=function(t){return a.put(o+"/password",t)},n}]),angular.module("cms.account").controller("AccountDetailsController",["shared.LoadState","shared.modalDialogService","shared.permissionValidationService","account.accountService","account.modulePath",function(t,a,n,o,e){var c=this;function u(){c.editMode=!0,c.mainForm.formStatus.clear()}function r(){l(c.saveLoadState),o.update(c.command).then(function(t){return i().then(c.mainForm.formStatus.success.bind(null,t))}.bind(null,"Changes were saved successfully")).finally(m.bind(null,c.saveLoadState))}function d(){c.editMode=!1,c.command=s(c.user),c.mainForm.formStatus.clear()}function i(){return o.getAccountDetails().then(function(t){c.user=t,c.command=s(t),c.editMode=!1})}function s(t){return _.pick(t,"firstName","lastName","email")}function l(t){c.globalLoadState.on(),t&&_.isFunction(t.on)&&t.on()}function m(t){c.globalLoadState.off(),t&&_.isFunction(t.off)&&t.off()}c.edit=u,c.save=r,c.cancel=d,c.editMode=!1,c.globalLoadState=new t,c.saveLoadState=new t,c.formLoadState=new t(!0),c.canUpdate=n.canUpdate("COFCUR"),i().then(m.bind(null,c.formLoadState))}]),angular.module("cms.account").controller("ChangePasswordController",["$location","shared.LoadState","shared.modalDialogService","account.accountService",function(t,a,n,o){var e=this;function c(){e.globalLoadState.on(),o.updatePassword(e.command).then(d).finally(e.globalLoadState.off)}function u(){d()}function r(t){return!!e.command&&e.command.newPassword===t}function d(){t.path("/")}e.save=c,e.cancel=u,e.doesPasswordMatch=r,e.globalLoadState=new a,e.formLoadState=new a(!0),o.getAccountDetails().then(function(t){e.user=t,e.command={}}).then(e.formLoadState.off)}]);